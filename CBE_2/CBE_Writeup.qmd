---
title: "CBE 2"
author: "Amalia, Lauren, and Jenny"
date: last-modified
format:
  pdf:
    number-sections: true
    indent: true
    toc: true
    include-in-header:
      text: |
        \addtokomafont{disposition}{\rmfamily}
        \usepackage{fvextra}
        \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
execute:
  echo: false
---

\newpage

# Introduction

# Data

```{r, include=FALSE}
library(quanteda)
library(quanteda.textstats)
library(tidyverse)
library(sentimentr)
library(knitr)
library(gt)
library(syuzhet)
library(tidytext)
library(dplyr)
source("../R/helper_functions.R")
source("../R/keyness_functions.R")

```

```{r}

txt_1945 <- paste(readLines("Text Files/the_other_side_of_the_hedge_1945.txt"), collapse = " ")

txt_1852 <- paste(readLines("Text Files/the_old_nurses_story_1852.txt"), collapse = " ")

txt_1952 <- paste(readLines("Text Files/the_old_man_at_the_bridge_1952.txt"), collapse = " ")

txt_1950 <- paste(readLines("Text Files/the_mindworm_1950.txt"), collapse = " ")

txt_1842 <- paste(readLines("Text Files/the_masque_of_the_red_death_1842.txt"), collapse = " ")

txt_1940 <- paste(readLines("Text Files/the_man_who_killed_the_world_1940.txt"), collapse = " ")

txt_1859 <- paste(readLines("Text Files/the_lifted_veil_1859.txt"), collapse = " ")

txt_1839 <- paste(readLines("Text Files/the_fall_of_the_house_of_usher_1839.txt"), collapse = " ")

txt_1852 <- paste(readLines("Text Files/the_district_doctor_1852.txt"), collapse = " ")

txt_1954 <- paste(readLines("Text Files/the_destructors_1954.txt"), collapse = " ")

txt_1942 <- paste(readLines("Text Files/the_catbird_seat_1942.txt"), collapse = " ")

txt_1858 <- paste(readLines("Text Files/psyche's_art_1858.txt"), collapse = " ")


txt_1954b <- paste(readLines("Text Files/master_zacharius_1954.txt"), collapse = " ")

txt_1955 <- paste(readLines("Text Files/good_country_people_1955.txt"), collapse = " ")


txt_1853 <- paste(readLines("Text Files/gods_in_exile_1853.txt"), collapse = " ")


txt_1950b <- paste(readLines("Text Files/first_confession_1950.txt"), collapse = " ")

txt_1950c <- paste(readLines("Text Files/coming_attraction_1950.txt"), collapse = " ")

txt_1853b <- paste(readLines("Text Files/bartelby_the_scrivener_1853.txt"), collapse = " ")

txt_1852b <- paste(readLines("Text Files/a_terribly_strange_bed_1852.txt"), collapse = " ")

txt_1952b <- paste(readLines("Text Files/a_sound_of_thunder_1952.txt"), collapse = " ")

txt_1948 <- paste(readLines("Text Files/a_perfect_day_for_bananafish_1948.txt"), collapse = " ")

txt_1951 <- paste(readLines("Text Files/A_&_P_1951.txt"), collapse = " ")

```

```{r}

years_q <- c("1839", "1842", "1852", "1852b", "1853", "1853b", "1858", "1859", "1940", "1942", "1945", "1948", "1950", "1950b", "1950c", "1951", "1952", "1952b", "1954", "1954b", "1955")

years <- c(txt_1839, txt_1842, txt_1852, txt_1852b, txt_1853, txt_1853b, txt_1858, txt_1859, txt_1940, txt_1942, txt_1945, txt_1948, txt_1950, txt_1950b, txt_1950c, txt_1951, txt_1952, txt_1952b, txt_1954, txt_1954b, txt_1955)


short_stories_corpus <- data.frame(doc_id = years_q, text = years) %>%
   mutate(text = preprocess_text(text)) %>%
   corpus()

dfm_short_stories <- dfm_remove(dfm(tokens(short_stories_corpus)), stopwords("en"))

lexdiv_pshort_stories <- textstat_lexdiv(dfm_short_stories, measure = c("CTTR", "U", "R", "C", "TTR", "K", "I", "Mass", "S"))

### TTR is the Type Token Ratio --> tells us lexical diversity
plot(lexdiv_pshort_stories$TTR, type = "l", xaxt = "n", xlab = NULL, ylab = "TTR")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### C is the Log Type Token Ratio --> tells us lexical diversity
plot(lexdiv_pshort_stories$C, type = "l", xaxt = "n", xlab = NULL, ylab = "log(TTR)")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### R is the Root Type Token Ratio --> tells us lexical diversity
plot(lexdiv_pshort_stories$R, type = "l", xaxt = "n", xlab = NULL, ylab = "Root TTR")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### CTTR is the Corrected Type Token Ratio --> tells us lexical diversity corrected for text length
plot(lexdiv_pshort_stories$CTTR, type = "l", xaxt = "n", xlab = NULL, ylab = "Corrected TTR")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### U is the Uber Index --> this is another mesure of lexical richness and diversity which is less sensitive to text length
plot(lexdiv_pshort_stories$U, type = "l", xaxt = "n", xlab = NULL, ylab = "Uber Index")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### S is the Summer's Index --> similar to Uber's Index
plot(lexdiv_pshort_stories$S, type = "l", xaxt = "n", xlab = NULL, ylab = "Summer Index")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### K is the Yule's K --> quantifies how varied vocab is within a given text and specifically captures the distribution of word frequencies; more stable, for larger texts
plot(lexdiv_pshort_stories$K, type = "l", xaxt = "n", xlab = NULL, ylab = "Yule's K")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### I is Yule's I --> quantifies the uneveness in the frequency distribution of words in a text; focusses on the distribution of unique words' frequencies
plot(lexdiv_pshort_stories$I, type = "l", xaxt = "n", xlab = NULL, ylab = "Yule's I")
grid()
axis(1, at = seq_len(nrow(lexdiv_pshort_stories)), labels = years_q)

### Maas is Maas' Indices --> tells us ????
```


# Methods

# Results

# Discussion

# Acknowledgments {.appendix}

# Works Cited
